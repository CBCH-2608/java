<?xml version="1.0" encoding="UTF-8"?>

<BugCollection version="4.1.4" sequence="0" timestamp="1633360298000" analysisTimestamp="1633360300316" release="">
  <Project projectName="">
    <Jar>target/my-app-verybad-1.0-SNAPSHOT.jar</Jar>
    <Plugin id="com.h3xstream.findsecbugs" enabled="true"/>
  </Project>
  <BugInstance type="PATH_TRAVERSAL_IN" priority="1" rank="10" abbrev="SECPTI" category="SECURITY" instanceHash="55e1cef3f23cf25804d8899f939bc8a4" instanceOccurrenceNum="0" instanceOccurrenceMax="0" cweid="22">
    <ShortMessage>Potential Path Traversal (file read)</ShortMessage>
    <LongMessage>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V) reads a file whose location might be specified by user input</LongMessage>
    <Class classname="com.verybadcompany.app.cwe.CWE22" primary="true">
      <SourceLine classname="com.verybadcompany.app.cwe.CWE22" start="14" end="26" sourcefile="CWE22.java" sourcepath="com/verybadcompany/app/cwe/CWE22.java">
        <Message>At CWE22.java:[lines 14-26]</Message>
      </SourceLine>
      <Message>In class com.verybadcompany.app.cwe.CWE22</Message>
    </Class>
    <Method classname="com.verybadcompany.app.cwe.CWE22" name="getImage" signature="(Ljava/lang/String;)Ljavax/ws/rs/core/Response;" isStatic="false" primary="true">
      <SourceLine classname="com.verybadcompany.app.cwe.CWE22" start="20" end="26" startBytecode="0" endBytecode="133" sourcefile="CWE22.java" sourcepath="com/verybadcompany/app/cwe/CWE22.java"/>
      <Message>In method com.verybadcompany.app.cwe.CWE22.getImage(String)</Message>
    </Method>
    <SourceLine classname="com.verybadcompany.app.cwe.CWE22" primary="true" start="20" end="20" startBytecode="7" endBytecode="7" sourcefile="CWE22.java" sourcepath="com/verybadcompany/app/cwe/CWE22.java">
      <Message>At CWE22.java:[line 20]</Message>
    </SourceLine>
    <String value="java/io/File.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V" role="Sink method">
      <Message>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V</Message>
    </String>
    <String value="0" role="Sink parameter">
      <Message>Sink parameter 0</Message>
    </String>
    <String value="com/verybadcompany/app/cwe/CWE22.getImage(Ljava/lang/String;)Ljavax/ws/rs/core/Response; parameter 0" role="Tainted source">
      <Message>Tainted source com/verybadcompany/app/cwe/CWE22.getImage(Ljava/lang/String;)Ljavax/ws/rs/core/Response; parameter 0</Message>
    </String>
  </BugInstance>
  <BugInstance type="PREDICTABLE_RANDOM" priority="2" rank="12" abbrev="SECPR" category="SECURITY" instanceHash="ba765449d3181162cc7a91a36fa4f08e" instanceOccurrenceNum="0" instanceOccurrenceMax="0" cweid="330">
    <ShortMessage>Predictable pseudorandom number generator</ShortMessage>
    <LongMessage>This random generator (java.util.Random) is predictable</LongMessage>
    <Class classname="com.verybadcompany.app.cwe.CWE330" primary="true">
      <SourceLine classname="com.verybadcompany.app.cwe.CWE330" start="8" end="16" sourcefile="CWE330.java" sourcepath="com/verybadcompany/app/cwe/CWE330.java">
        <Message>At CWE330.java:[lines 8-16]</Message>
      </SourceLine>
      <Message>In class com.verybadcompany.app.cwe.CWE330</Message>
    </Class>
    <Method classname="com.verybadcompany.app.cwe.CWE330" name="generateSecretToken" signature="()Ljava/lang/String;" isStatic="false" primary="true">
      <SourceLine classname="com.verybadcompany.app.cwe.CWE330" start="15" end="16" startBytecode="0" endBytecode="71" sourcefile="CWE330.java" sourcepath="com/verybadcompany/app/cwe/CWE330.java"/>
      <Message>In method com.verybadcompany.app.cwe.CWE330.generateSecretToken()</Message>
    </Method>
    <SourceLine classname="com.verybadcompany.app.cwe.CWE330" primary="true" start="15" end="15" startBytecode="4" endBytecode="4" sourcefile="CWE330.java" sourcepath="com/verybadcompany/app/cwe/CWE330.java">
      <Message>At CWE330.java:[line 15]</Message>
    </SourceLine>
    <String value="java.util.Random">
      <Message>Value java.util.Random</Message>
    </String>
  </BugInstance>
  <BugInstance type="PATH_TRAVERSAL_IN" priority="1" rank="10" abbrev="SECPTI" category="SECURITY" instanceHash="ee78ce09c82a7c3d90518aaf439ff65f" instanceOccurrenceNum="0" instanceOccurrenceMax="0" cweid="22">
    <ShortMessage>Potential Path Traversal (file read)</ShortMessage>
    <LongMessage>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V) reads a file whose location might be specified by user input</LongMessage>
    <Class classname="com.verybadcompany.app.cwe.more.CWE22More" primary="true">
      <SourceLine classname="com.verybadcompany.app.cwe.more.CWE22More" start="16" end="28" sourcefile="CWE22More.java" sourcepath="com/verybadcompany/app/cwe/more/CWE22More.java">
        <Message>At CWE22More.java:[lines 16-28]</Message>
      </SourceLine>
      <Message>In class com.verybadcompany.app.cwe.more.CWE22More</Message>
    </Class>
    <Method classname="com.verybadcompany.app.cwe.more.CWE22More" name="getImage" signature="(Ljava/lang/String;)Ljavax/ws/rs/core/Response;" isStatic="false" primary="true">
      <SourceLine classname="com.verybadcompany.app.cwe.more.CWE22More" start="22" end="28" startBytecode="0" endBytecode="133" sourcefile="CWE22More.java" sourcepath="com/verybadcompany/app/cwe/more/CWE22More.java"/>
      <Message>In method com.verybadcompany.app.cwe.more.CWE22More.getImage(String)</Message>
    </Method>
    <SourceLine classname="com.verybadcompany.app.cwe.more.CWE22More" primary="true" start="22" end="22" startBytecode="7" endBytecode="7" sourcefile="CWE22More.java" sourcepath="com/verybadcompany/app/cwe/more/CWE22More.java">
      <Message>At CWE22More.java:[line 22]</Message>
    </SourceLine>
    <String value="java/io/File.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V" role="Sink method">
      <Message>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V</Message>
    </String>
    <String value="0" role="Sink parameter">
      <Message>Sink parameter 0</Message>
    </String>
    <String value="com/verybadcompany/app/cwe/more/CWE22More.getImage(Ljava/lang/String;)Ljavax/ws/rs/core/Response; parameter 0" role="Tainted source">
      <Message>Tainted source com/verybadcompany/app/cwe/more/CWE22More.getImage(Ljava/lang/String;)Ljavax/ws/rs/core/Response; parameter 0</Message>
    </String>
  </BugInstance>
  <BugInstance type="PATH_TRAVERSAL_IN" priority="1" rank="10" abbrev="SECPTI" category="SECURITY" instanceHash="213f15cd1165252ba28c85842b2d3595" instanceOccurrenceNum="0" instanceOccurrenceMax="0" cweid="22">
    <ShortMessage>Potential Path Traversal (file read)</ShortMessage>
    <LongMessage>This API (java/io/File.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V) reads a file whose location might be specified by user input</LongMessage>
    <Class classname="com.verybadcompany.app.cwe.more.again.CWE22MoreAgain" primary="true">
      <SourceLine classname="com.verybadcompany.app.cwe.more.again.CWE22MoreAgain" start="16" end="28" sourcefile="CWE22MoreAgain.java" sourcepath="com/verybadcompany/app/cwe/more/again/CWE22MoreAgain.java">
        <Message>At CWE22MoreAgain.java:[lines 16-28]</Message>
      </SourceLine>
      <Message>In class com.verybadcompany.app.cwe.more.again.CWE22MoreAgain</Message>
    </Class>
    <Method classname="com.verybadcompany.app.cwe.more.again.CWE22MoreAgain" name="getImage" signature="(Ljava/lang/String;)Ljavax/ws/rs/core/Response;" isStatic="false" primary="true">
      <SourceLine classname="com.verybadcompany.app.cwe.more.again.CWE22MoreAgain" start="22" end="28" startBytecode="0" endBytecode="133" sourcefile="CWE22MoreAgain.java" sourcepath="com/verybadcompany/app/cwe/more/again/CWE22MoreAgain.java"/>
      <Message>In method com.verybadcompany.app.cwe.more.again.CWE22MoreAgain.getImage(String)</Message>
    </Method>
    <SourceLine classname="com.verybadcompany.app.cwe.more.again.CWE22MoreAgain" primary="true" start="22" end="22" startBytecode="7" endBytecode="7" sourcefile="CWE22MoreAgain.java" sourcepath="com/verybadcompany/app/cwe/more/again/CWE22MoreAgain.java">
      <Message>At CWE22MoreAgain.java:[line 22]</Message>
    </SourceLine>
    <String value="java/io/File.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V" role="Sink method">
      <Message>Sink method java/io/File.&lt;init&gt;(Ljava/lang/String;Ljava/lang/String;)V</Message>
    </String>
    <String value="0" role="Sink parameter">
      <Message>Sink parameter 0</Message>
    </String>
    <String value="com/verybadcompany/app/cwe/more/again/CWE22MoreAgain.getImage(Ljava/lang/String;)Ljavax/ws/rs/core/Response; parameter 0" role="Tainted source">
      <Message>Tainted source com/verybadcompany/app/cwe/more/again/CWE22MoreAgain.getImage(Ljava/lang/String;)Ljavax/ws/rs/core/Response; parameter 0</Message>
    </String>
  </BugInstance>
  <BugCategory category="SECURITY">
    <Description>Security</Description>
  </BugCategory>
  <BugPattern type="PATH_TRAVERSAL_IN" abbrev="SECPTI" category="SECURITY" cweid="22">
    <ShortDescription>Potential Path Traversal (file read)</ShortDescription>
    <Details><![CDATA[
            
<p>A file is opened to read its content. The filename comes from an <b>input</b> parameter.
If an unfiltered parameter is passed to this file API, files from an arbitrary filesystem location could be read.</p>
<p>This rule identifies <b>potential</b> path traversal vulnerabilities. In many cases, the constructed file path cannot be controlled
by the user. If that is the case, the reported instance is a false positive.</p>
<br/>

<p>
    <b>Vulnerable Code:</b><br/>
<pre>@GET
@Path("/images/{image}")
@Produces("images/*")
public Response getImage(@javax.ws.rs.PathParam("image") String image) {
    File file = new File("resources/images/", image); //Weak point

    if (!file.exists()) {
        return Response.status(Status.NOT_FOUND).build();
    }

    return Response.ok().entity(new FileInputStream(file)).build();
}</pre>
</p>
<br/>

<p>
    <b>Solution:</b><br/>
<pre>import org.apache.commons.io.FilenameUtils;

@GET
@Path("/images/{image}")
@Produces("images/*")
public Response getImage(@javax.ws.rs.PathParam("image") String image) {
    File file = new File("resources/images/", FilenameUtils.getName(image)); //Fix

    if (!file.exists()) {
        return Response.status(Status.NOT_FOUND).build();
    }

    return Response.ok().entity(new FileInputStream(file)).build();
}</pre>
</p>
<br/>
<p>
<b>References</b><br/>
<a href="http://projects.webappsec.org/w/page/13246952/Path%20Traversal">WASC: Path Traversal</a><br/>
<a href="https://www.owasp.org/index.php/Path_Traversal">OWASP: Path Traversal</a><br/>
<a href="https://capec.mitre.org/data/definitions/126.html">CAPEC-126: Path Traversal</a><br/>
<a href="https://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a>
</p>

        ]]></Details>
  </BugPattern>
  <BugPattern type="PREDICTABLE_RANDOM" abbrev="SECPR" category="SECURITY" cweid="330">
    <ShortDescription>Predictable pseudorandom number generator</ShortDescription>
    <Details><![CDATA[
            
<p>The use of a predictable random value can lead to vulnerabilities when used in certain security critical contexts. For example, when the value is used as:</p>
<ul>
<li>a CSRF token: a predictable token can lead to a CSRF attack as an attacker will know the value of the token</li>
<li>a password reset token (sent by email): a predictable password token can lead to an account takeover, since an attacker will guess the URL of the "change password" form</li>
<li>any other secret value</li>
</ul>
<p>
A quick fix could be to replace the use of <code>java.util.Random</code> with something stronger, such as <code>java.security.SecureRandom</code>.
</p>
<p>
<b>Vulnerable Code:</b><br/>
<pre>String generateSecretToken() {
    Random r = new Random();
    return Long.toHexString(r.nextLong());
}</pre>
</p>
<p>
<b>Solution:</b>
<pre>import org.apache.commons.codec.binary.Hex;

String generateSecretToken() {
    SecureRandom secRandom = new SecureRandom();

    byte[] result = new byte[32];
    secRandom.nextBytes(result);
    return Hex.encodeHexString(result);
}</pre>
</p>
<br/>
<p>
<b>References</b><br/>
<a href="https://jazzy.id.au/2010/09/20/cracking_random_number_generators_part_1.html">Cracking Random Number Generators - Part 1 (https://jazzy.id.au)</a><br/>
<a href="https://www.securecoding.cert.org/confluence/display/java/MSC02-J.+Generate+strong+random+numbers">CERT: MSC02-J. Generate strong random numbers</a><br/>
<a href="https://cwe.mitre.org/data/definitions/330.html">CWE-330: Use of Insufficiently Random Values</a><br/>
<a href="https://blog.h3xstream.com/2014/12/predicting-struts-csrf-token-cve-2014.html">Predicting Struts CSRF Token (Example of real-life vulnerability and exploitation)</a>
</p>

        ]]></Details>
  </BugPattern>
  <BugCode abbrev="SECPR">
    <Description>Predictable Pseudo Random Generator</Description>
  </BugCode>
  <BugCode abbrev="SECPTI">
    <Description>Potential Path Traversal (file read)</Description>
  </BugCode>
  <Errors errors="0" missingClasses="3">
    <MissingClass>javax.ws.rs.core.Response</MissingClass>
    <MissingClass>javax.ws.rs.core.Response$ResponseBuilder</MissingClass>
    <MissingClass>javax.ws.rs.core.Response$Status</MissingClass>
  </Errors>
  <FindBugsSummary timestamp="Mon, 4 Oct 2021 16:11:38 +0100" total_classes="6" referenced_classes="22" total_bugs="4" total_size="45" num_packages="4" java_version="1.8.0_172" vm_version="25.172-b11" cpu_seconds="8.07" clock_seconds="3.05" peak_mbytes="111.78" alloc_mbytes="3641.00" gc_seconds="0.04" priority_2="1" priority_1="3">
    <FileStats path="com/verybadcompany/app/App.java" bugCount="0" size="11"/>
    <FileStats path="com/verybadcompany/app/cwe/CWE22.java" bugCount="1" size="8" bugHash="94b9b22035c532d6bacf024675f20072"/>
    <FileStats path="com/verybadcompany/app/cwe/CWE330.java" bugCount="1" size="9" bugHash="f3bb973c0ddfe03ca042f421077ec3cf"/>
    <FileStats path="com/verybadcompany/app/cwe/CWEExample.java" bugCount="0" size="1"/>
    <FileStats path="com/verybadcompany/app/cwe/more/CWE22More.java" bugCount="1" size="8" bugHash="963b6fab3193c31c1ca72075344f7772"/>
    <FileStats path="com/verybadcompany/app/cwe/more/again/CWE22MoreAgain.java" bugCount="1" size="8" bugHash="6058574d11b73140240d7c0ee96be659"/>
    <PackageStats package="com.verybadcompany.app" total_bugs="0" total_types="1" total_size="11">
      <ClassStats class="com.verybadcompany.app.App" sourceFile="App.java" interface="false" size="11" bugs="0"/>
    </PackageStats>
    <PackageStats package="com.verybadcompany.app.cwe" total_bugs="2" total_types="3" total_size="18" priority_2="1" priority_1="1">
      <ClassStats class="com.verybadcompany.app.cwe.CWE22" sourceFile="CWE22.java" interface="false" size="8" bugs="1" priority_1="1"/>
      <ClassStats class="com.verybadcompany.app.cwe.CWE330" sourceFile="CWE330.java" interface="false" size="9" bugs="1" priority_2="1"/>
      <ClassStats class="com.verybadcompany.app.cwe.CWEExample" sourceFile="CWEExample.java" interface="true" size="1" bugs="0"/>
    </PackageStats>
    <PackageStats package="com.verybadcompany.app.cwe.more" total_bugs="1" total_types="1" total_size="8" priority_1="1">
      <ClassStats class="com.verybadcompany.app.cwe.more.CWE22More" sourceFile="CWE22More.java" interface="false" size="8" bugs="1" priority_1="1"/>
    </PackageStats>
    <PackageStats package="com.verybadcompany.app.cwe.more.again" total_bugs="1" total_types="1" total_size="8" priority_1="1">
      <ClassStats class="com.verybadcompany.app.cwe.more.again.CWE22MoreAgain" sourceFile="CWE22MoreAgain.java" interface="false" size="8" bugs="1" priority_1="1"/>
    </PackageStats>
    <FindBugsProfile>
      <ClassProfile name="edu.umd.cs.findbugs.classfile.engine.ClassInfoAnalysisEngine" totalMilliseconds="415" invocations="392" avgMicrosecondsPerInvocation="1059" maxMicrosecondsPerInvocation="33787" standardDeviationMicrosecondsPerInvocation="2697"/>
      <ClassProfile name="edu.umd.cs.findbugs.detect.FieldItemSummary" totalMilliseconds="142" invocations="22" avgMicrosecondsPerInvocation="6473" maxMicrosecondsPerInvocation="24764" standardDeviationMicrosecondsPerInvocation="7278"/>
      <ClassProfile name="edu.umd.cs.findbugs.detect.FindNoSideEffectMethods" totalMilliseconds="116" invocations="22" avgMicrosecondsPerInvocation="5304" maxMicrosecondsPerInvocation="21719" standardDeviationMicrosecondsPerInvocation="7134"/>
      <ClassProfile name="edu.umd.cs.findbugs.OpcodeStack$JumpInfoFactory" totalMilliseconds="100" invocations="87" avgMicrosecondsPerInvocation="1160" maxMicrosecondsPerInvocation="21532" standardDeviationMicrosecondsPerInvocation="2624"/>
      <ClassProfile name="edu.umd.cs.findbugs.classfile.engine.bcel.JavaClassAnalysisEngine" totalMilliseconds="82" invocations="56" avgMicrosecondsPerInvocation="1466" maxMicrosecondsPerInvocation="41148" standardDeviationMicrosecondsPerInvocation="5700"/>
      <ClassProfile name="edu.umd.cs.findbugs.util.TopologicalSort" totalMilliseconds="79" invocations="353" avgMicrosecondsPerInvocation="226" maxMicrosecondsPerInvocation="4944" standardDeviationMicrosecondsPerInvocation="453"/>
      <ClassProfile name="edu.umd.cs.findbugs.classfile.engine.bcel.MethodGenFactory" totalMilliseconds="69" invocations="12" avgMicrosecondsPerInvocation="5812" maxMicrosecondsPerInvocation="60082" standardDeviationMicrosecondsPerInvocation="16436"/>
      <ClassProfile name="edu.umd.cs.findbugs.detect.NoteDirectlyRelevantTypeQualifiers" totalMilliseconds="58" invocations="22" avgMicrosecondsPerInvocation="2641" maxMicrosecondsPerInvocation="19245" standardDeviationMicrosecondsPerInvocation="4192"/>
      <ClassProfile name="edu.umd.cs.findbugs.detect.FunctionsThatMightBeMistakenForProcedures" totalMilliseconds="50" invocations="22" avgMicrosecondsPerInvocation="2315" maxMicrosecondsPerInvocation="21710" standardDeviationMicrosecondsPerInvocation="4682"/>
      <ClassProfile name="edu.umd.cs.findbugs.classfile.engine.ClassDataAnalysisEngine" totalMilliseconds="50" invocations="393" avgMicrosecondsPerInvocation="129" maxMicrosecondsPerInvocation="6837" standardDeviationMicrosecondsPerInvocation="443"/>
      <ClassProfile name="com.h3xstream.findsecbugs.taintanalysis.TaintDataflowEngine" totalMilliseconds="50" invocations="12" avgMicrosecondsPerInvocation="4191" maxMicrosecondsPerInvocation="36579" standardDeviationMicrosecondsPerInvocation="9840"/>
      <ClassProfile name="edu.umd.cs.findbugs.detect.BuildObligationPolicyDatabase" totalMilliseconds="42" invocations="22" avgMicrosecondsPerInvocation="1954" maxMicrosecondsPerInvocation="15281" standardDeviationMicrosecondsPerInvocation="3484"/>
      <ClassProfile name="edu.umd.cs.findbugs.detect.OverridingEqualsNotSymmetrical" totalMilliseconds="38" invocations="22" avgMicrosecondsPerInvocation="1742" maxMicrosecondsPerInvocation="15967" standardDeviationMicrosecondsPerInvocation="3943"/>
      <ClassProfile name="edu.umd.cs.findbugs.detect.BuildStringPassthruGraph" totalMilliseconds="34" invocations="22" avgMicrosecondsPerInvocation="1562" maxMicrosecondsPerInvocation="12516" standardDeviationMicrosecondsPerInvocation="2841"/>
      <ClassProfile name="edu.umd.cs.findbugs.classfile.engine.bcel.CFGFactory" totalMilliseconds="31" invocations="12" avgMicrosecondsPerInvocation="2636" maxMicrosecondsPerInvocation="20278" standardDeviationMicrosecondsPerInvocation="5419"/>
      <ClassProfile name="com.h3xstream.findsecbugs.file.PathTraversalDetector" totalMilliseconds="31" invocations="6" avgMicrosecondsPerInvocation="5203" maxMicrosecondsPerInvocation="28143" standardDeviationMicrosecondsPerInvocation="10268"/>
      <ClassProfile name="edu.umd.cs.findbugs.detect.FindOpenStream" totalMilliseconds="28" invocations="6" avgMicrosecondsPerInvocation="4831" maxMicrosecondsPerInvocation="11119" standardDeviationMicrosecondsPerInvocation="4454"/>
      <ClassProfile name="edu.umd.cs.findbugs.classfile.engine.bcel.TypeDataflowFactory" totalMilliseconds="28" invocations="12" avgMicrosecondsPerInvocation="2349" maxMicrosecondsPerInvocation="18742" standardDeviationMicrosecondsPerInvocation="4977"/>
      <ClassProfile name="edu.umd.cs.findbugs.classfile.engine.bcel.IsNullValueDataflowFactory" totalMilliseconds="25" invocations="12" avgMicrosecondsPerInvocation="2094" maxMicrosecondsPerInvocation="10671" standardDeviationMicrosecondsPerInvocation="2907"/>
      <ClassProfile name="edu.umd.cs.findbugs.classfile.engine.bcel.ValueNumberDataflowFactory" totalMilliseconds="24" invocations="12" avgMicrosecondsPerInvocation="2066" maxMicrosecondsPerInvocation="17360" standardDeviationMicrosecondsPerInvocation="4634"/>
    </FindBugsProfile>
  </FindBugsSummary>
  <ClassFeatures></ClassFeatures>
  <History></History>
</BugCollection>
